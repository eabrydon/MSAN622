<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>D3 via Console</title>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/bootstrap-theme.min.css" rel="stylesheet">

	<style type="text/css">
	    body {
	        padding-top: 50px;
	        padding-bottom: 20px;
	    }
	</style>
    <style type="text/css">
    	.axis path,
		.axis line {
		    fill: none;
		    stroke: black;
		    shape-rendering: crispEdges;
		}

		.axis text {
		    font-family: sans-serif;
		    font-size: 11px;
		}
		.grid .tick {
    		stroke: lightgrey;
    		opacity: 0.7;
		}
		.grid path {
		    stroke-width: 0;
		}
		.bar:hover {
		  	fill: orange;
		}
	</style>

</head>

<body align="center">
	<nav class="navbar navbar-inverse navbar-fixed-top">
    	<div class="container">
        	<div class="navbar-header">
            	<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
	                <span class="sr-only">Toggle Navigation</span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
	                <span class="icon-bar"></span>
            	</button>
           		<a class="navbar-brand" href="#">MSAN 622</a>
        	</div>

	        <div id="navbar" class="navbar-collapse collapse">
	            <ul class="nav navbar-nav">
	                <li><a href="#homework">Homework</a></li>
	                <li><a href="#project">Project</a></li>
	                <li><a href="#participation">Participation</a></li>
	            </ul>

	            <ul class="nav navbar-nav navbar-right">
	                <li><a href="#about">About</a></li>
	                <li><a href="#contact">Contact</a></li>
	            </ul>
	        </div><!--/.nav-collapse -->
	    </div>
	</nav>
	<div class="jumbotron">
    	<div class="container">
        	<h1>Homework 1</h1>
        	<p>Letter Counter Bar Chart</p>
    	</div>
	</div>
	<script>
		//colors
		var colors = {
		    "grey":     "#bbbbbb",
		    "blue":     "#377eb8",
		    "purple":   "#984ea3",
		    "green":    "#4daf4a",
		    "orange":   "#ff7f00",
		    "lightgrey":"#d3d3d3"
		};

		//get data for bar chart
		// grabs URL after ?, decodes, puts in lowercase
		var myRe = /\?(.+)/g.exec(decodeURI(document.URL))[1].toLowerCase();
		console.log(myRe);
		// gets all letters from decoded url
		var myLetters = myRe.match(/[a-z]/g);
		// makes a dictionary with letters:count as key:value
		var dict = new Object();
		for (var i in myLetters) {
		    if (dict.hasOwnProperty(myLetters[i])) {
		        dict[myLetters[i]] += 1
		    }
		    else {
		        var propertyName = myLetters[i]
		        dict[propertyName] = 1
		    }
		};
		//logs to console
		console.log(dict);
		//gets max value from dict for scaling the chart
		var max = 0;
		for( x in dict) {
		    if( dict[x] > max) max = dict[x];
		}
		//set useful variables
		var padding = 50
		var w = 1000;
		var h = 500;
		var barPadding = 5;
		//get list of letters for labels
		var letters = Object.keys(dict);
		var nBars = letters.length;

		//Create SVG element
		var svg = d3.select("body")
					.append("svg")
					.attr("width", w + padding)
					.attr("height", h + padding);
					// .style('background-color', colors.grey);

		// svg.append("g")         
	 //        .attr("class", "grid")
	 //        .call(make_y_axis()
	 //            .tickSize(-w, 0, 0)
	 //            .tickFormat("")
	 //        )

		//Bars
		svg.selectAll("rect")
		   .data(letters)
		   .enter()
		   .append("rect")		   
		   .attr("class","bar")
		   .attr("fill", colors.blue)
		   .attr("x", function(d, i) {
		        return padding/2 + i * (w / nBars);
		        })
		   .attr("y",  function(d) {
		        return (padding/2 + h - dict[d] * h / max);
		    })
		   .attr("width", w / nBars - barPadding)
		   .attr("height", function(d) {
		   		return (dict[d] * h / max);
		   });

		//Labels for bars
		svg.selectAll("text")
		   .data(letters)
		   .enter()
		   .append("text")
		   .attr("text-anchor","middle")
		   .text(function(d) {
        		return d;
 		  	})
		   .attr("x", function(d, i) {
		        return padding/2 + i * (w / nBars) + (w/nBars)/2;
		    })
		   .attr("y", function(d) {
		   		return (h + 3  * padding/4.0);
		   });
		   // .attr("fill", colors.blue);


		//Define y scale
	    var yScale = d3.scale.linear()
                 .domain([max, 0])
                 .range([0, h]);

		//Define Y axis
		var yAxis = d3.svg.axis()
		                  .scale(yScale)
		                  .orient("left")
		                  .ticks(max);

		//grid line function
		// function make_y_axis() {        
		//     return d3.svg.axis()
		//         .scale(yScale)
		//         .orient("left")
		//         .ticks(max)
		// }		                  

		//Create Y axis
		svg.append("g")
		    .attr("class", "axis")
		    .attr("transform", "translate(" + (padding/2 - barPadding) + "," + padding/2 + ")")
		    .attr("width", 2)
		    .call(yAxis);
	

		</script>
		<footer>
    		<p style="text-align: center;">Evan Brydon &bullet; MSAN 622 Information Visualization &bullet; Spring 2015</p>
		</footer>
	</body>
</html>

